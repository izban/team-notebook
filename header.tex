\documentclass[portrait,twocolumn,letterpaper]{article}
\usepackage[utf8x]{inputenc}
\usepackage[russian]{babel}
\usepackage[T1]{fontenc}
\usepackage{listings}
\usepackage{comment}
\usepackage{amssymb}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{titlesec, blindtext, color}
\usepackage{graphicx,epstopdf}

%\setlength{\columnseprule}{0.4pt}
\setlength{\columnsep}{25pt}
\usepackage{pdfpages}

\usepackage{fancyhdr}
\pagestyle{fancy}
\usepackage{lastpage}

\usepackage{geometry}
 \geometry{
 a4paper,
 %total={170mm,257mm},
 left=10mm,
 top=20mm,
 right=10mm,
 bottom=13mm,
 }
 
\newlength\FHoffset
\setlength\FHoffset{0mm}
\addtolength\headwidth{2\FHoffset}
\fancyheadoffset{\FHoffset}

\lhead{SPb ITMO University}
\chead{(.\_.)}
\rhead{Page \thepage\ of \pageref{LastPage}}


\fontsize{8}{11}\selectfont
\definecolor{lbcolor}{rgb}{0.9,0.9,0.9}
\lstset{
		%backgroundcolor=\color{lbcolor},
    	tabsize=2,    
    	language=[GNU]C++,
        basicstyle=\scriptsize,
        aboveskip={1.5\baselineskip},
        columns=fixed,
        showstringspaces=false,
        extendedchars=false,
        breaklines=true,
        prebreak = \raisebox{0ex}[0ex][0ex]{\ensuremath{\hookleftarrow}},
        frame=single,
        numbers=left,
        showtabs=false,
        showspaces=false,
        showstringspaces=false,
        identifierstyle=\ttfamily,
        keywordstyle=\color[rgb]{0,0,1},
        %commentstyle=\color[rgb]{0.026,0.112,0.095},
        commentstyle=\color[rgb]{0.200,0.800,0.200},
        stringstyle=\color[rgb]{0.627,0.126,0.941},
        numberstyle=\color[rgb]{0.205, 0.142, 0.73},
        literate={\ \ }{{\ }}1
}


\makeatletter 
\newcommand\saferead[1]{% 
\bgroup 
\let\do\@makeother 
\dospecials\catcode`\ 10 
\input{#1}% 
\egroup 
} 
\makeatother

\epstopdfsetup{suffix=}
\DeclareGraphicsExtensions{.ps}
\DeclareGraphicsRule{.ps}{pdf}{.pdf}{`ps2pdf -dEPSCrop -dNOSAFER #1 \noexpand\OutputFile}

%\titleformat*{\section}{\Small}
\addtocontents{toc}{\protect\enlargethispage{\baselineskip}}


